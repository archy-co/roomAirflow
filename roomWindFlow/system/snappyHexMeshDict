/*--------------------------------*- C++ -*----------------------------------*\
  =========                 |
  \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox
   \\    /   O peration     | Website:  https://openfoam.org
    \\  /    A nd           | Version:  10
     \\/     M anipulation  |
\*---------------------------------------------------------------------------*/
FoamFile
{
    format      ascii;
    class       dictionary;
    object      snappyHexMeshDict;
}
// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

#includeEtc "caseDicts/mesh/generation/snappyHexMeshDict.cfg"

castellatedMesh on;
snap            on;
addLayers       off;

geometry
{
    room
    {
        type triSurfaceMesh;
        file "COMMA_House_Bedroom.stl"
        name Geometry;
        regions
        {
            // patch name specification 
            // regionNameInSTLfile    {name    patchNameInOpenFOAM;}
            Geometry                {name RoomGeometry;      }
            Air_Conditioner         {name AirCon;            }
            Air_Conditioner_Inlet   {name inlet;             }

            Bed1                    {name Bed1;              }
            Bed1_Delim              {name Bed1_Delim;        }
            Bed2                    {name Bed2;              }

            Door_1_Close            {name Door1_Close;       }

            Door_2_Close            {name Door2_Close;       }
            Door_2_Lower            {name Door2_Lower;       }
            Door_2_Open             {name Door2_Open;        }
            Door_2_Upper_Close      {name Door2_Upper_Close; }
            Door_2_Upper_Open       {name Door2_Upper_Open;  }

            Door_3_Close            {name Door3_Close;       }
            Door_3_Open             {name Door3_Open;        }

            Floor                   {name Floor;             }
            Roof                    {name Roof;              }

            Window_1                {name Window_1;          }
            Window_2                {name Window_2;          }
            Window_3                {name outlet;            }
        }
    }
};

castellatedMeshControls
{
    features
    (
      //{ file  "Room.eMesh"; level 1; }
    );

    refinementSurfaces
    {
        room
        {
            level (2 2);
            regions
            {
                // surface region refinement 
                // patch type specification
                // stlRegionName     { level (default feature_angle_resolved); patchInfo { type patchType; }
                inlet     {
                    level (2 2);
                    patchInfo { type wall;         }
                }
                outlet    {
                    level (2 2);
                    patchInfo { type wall;         }
                }

                RoomGeometry  {
                    level (2 2);
                    patchInfo { type wall;          }
                }
                AirCon  {
                    level (2 2);
                    patchInfo { type wall;          }
                }

                Bed1  {
                    level (2 2);
                    patchInfo { type wall;          }
                }
                Bed1_Delim  {
                    level (2 2);
                    patchInfo { type wall;          }
                }
                Bed2  {
                    level (2 2);
                    patchInfo { type wall;          }
                }
                Door_1_Close  {
                    level (2 2);
                    patchInfo { type wall;          }
                }


                Door_1_Close  {
                    level (2 2);
                    patchInfo { type wall;          }
                }
                Door_2_Close  {
                    level (2 2);
                    patchInfo { type wall;          }
                }
                Door_2_Lower  {
                    level (2 2);
                    patchInfo { type wall;          }
                }
                Door_2_Open  {
                    level (2 2);
                    patchInfo { type wall;          }
                }
                Door_2_Upper_Close  {
                    level (2 2);
                    patchInfo { type wall;          }
                }
                Door_2_Upper_Open  {
                    level (2 2);
                    patchInfo { type wall;          }
                }

                Door_3_Close  {
                    level (2 2);
                    patchInfo { type wall;          }
                }
                Door_3_Open  {
                    level (2 2);
                    patchInfo { type wall;          }
                }
                Floor  {
                    level (2 2);
                    patchInfo { type wall;          }
                }
                Roof  {
                    level (2 2);
                    patchInfo { type wall;          }
                }
                Window_1  {
                    level (2 2);
                    patchInfo { type wall;          }
                }
                Window_2  {
                    level (2 2);
                    patchInfo { type wall;          }
                }
                //Window_3  {
                    //level (2 2);
                    //patchInfo { type wall;          }
                //}

            }
            patchInfo { type wall; }
        }
    }

    //refinementRegions
    //{
        //refinementBox
        //{
            //mode    inside;
            //level   2;
        //}
    //}

    locationInMesh (5 5 5); // Offset from (0 0 0) to avoid coinciding with face or edge
    nCellsBetweenLevels 2;
}

snapControls
{
    //explicitFeatureSnap    true;
    //implicitFeatureSnap    false;
}

addLayersControls
{
    layers
    {
        "CAD.*"
        {
            nSurfaceLayers 2;
        }
    }

    relativeSizes       true;
    expansionRatio      1.2;
    finalLayerThickness 0.5;
    minThickness        1e-3;
}

meshQualityControls
{}

writeFlags
(
    // scalarLevels
    // layerSets
    // layerFields
);

mergeTolerance 1e-6;

// ************************************************************************* //
